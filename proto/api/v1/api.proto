syntax = "proto3";

package api.v1;

option go_package = "github.com/openstatushq/openqueue/proto/gen/api/v1;api";

service QueueService {
  rpc CreateTask (CreateTaskRequest) returns (CreateTaskResponse) {}
  rpc GetTask (GetTaskRequest) returns (GetTaskResponse) {}
}

enum HTTPMethod {
    HTTP_METHOD_UNSPECIFIED = 0;
    HTTP_METHOD_GET = 1;
    HTTP_METHOD_POST = 2;
    HTTP_METHOD_PUT = 3;
    HTTP_METHOD_DELETE = 4;
    HTTP_METHOD_HEAD = 5;
    HTTP_METHOD_OPTIONS = 6;
    HTTP_METHOD_PATCH = 7;
    HTTP_METHOD_CONNECT = 8;
}

enum TaskStatus {
    TASK_STATUS_UNSPECIFIED = 0;
    TASK_STATUS_PENDING = 1;
    TASK_STATUS_IN_PROGRESS = 2;
    TASK_STATUS_COMPLETED = 3;
    TASK_STATUS_FAILED = 4;
}

message Task {
    string url = 1;
    string method = 2;
    map<string, string> headers = 3;
    string body = 4;
}

message CreateTaskRequest {
    string queue_name = 1;
    Task task = 2;
}
message CreateTaskResponse {
    string task_id = 1;
}

message GetTaskRequest {
    string task_id = 1;
    string queue_name = 2;
}

message GetTaskResponse {
    string task_id = 1;
    Task task = 2;
    TaskStatus status = 3;
}
